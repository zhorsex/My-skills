# Report Generator - Word模板管理

## 概述

本目录包含 report-generator skill 使用的 Word 文档模板。这些模板用于在生成最终 Word 文档时应用专业的格式样式。

## 可用模板

### 1. 地质资料归档格式模板 (geological-survey-template.docx) ⭐ 推荐

**适用场景：**
- 地质调查项目成果报告
- 地质勘查报告
- 矿产资源调查报告
- 环境地质调查报告

**标准依据：**
- 河南省国土资源厅豫国土资发［2006］144号文
- 《成果地质资料电子文件汇交格式要求》

**包含样式：**
- **封面样式**：地质调查项目成果报告、题名、单位、日期
- **扉页样式**：报告题名、项目信息、人员信息
- **目录样式**：目录标题、章标题、节标题
- **正文样式**：章标题、节标题、段标题、正文
- **表格样式**：表号、表名、表文、表注
- **图片样式**：图号图名、图注
- **参考文献样式**：标题、内容
- **页码样式**：罗马数字（目录）、阿拉伯数字（正文）

**页面设置：**
- 纸张：A4
- 边距：上2.75cm / 下2.75cm / 内侧2.86cm / 外侧2.27cm
- 装订线：1cm
- 页眉：1.5cm / 页脚：1.75cm

**特殊格式：**
- 数字与单位间空格："10 m"
- 数字范围波浪线：10～20 m
- 中文地名一字线：郑州—开封
- 比例尺比例号：1∶10000
- 表格边框：1.5磅外框、0.5磅内线

---

### 2. 通用工程技术报告模板 (generic-engineering-template.docx) [待添加]

---

## 大纲模板（新增）

本目录包含交互式大纲生成功能使用的模板库。

### 目录结构

```
templates/
├── [现有的 Word 模板文件]
│
└── outline-templates/          # 大纲模板目录（新增）
    ├── standard-outline-templates.md   # 标准大纲模板
    ├── industry-outlines/               # 行业大纲模板
    │   ├── geological-survey.md        # 地质调查报告大纲
    │   ├── engineering-design.md         # 工程设计方案大纲
    │   └── environmental-assessment.md  # 环境影响评估报告大纲
    ├── index.md                      # 模板索引
    └── README.md                     # 本文件
```

### 大纲模板类型

#### 标准大纲模板（按详细程度）

| 模板ID | 模板名称 | 详细程度 | 章节数量 | 适用场景 |
|--------|---------|---------|---------|---------|
| OT001 | 精简版快速报告 | 精简 | 3-4 | 内部汇报、快速评估、简要说明 |
| OT002 | 标准版综合报告 | 标准 | 5-6 | 项目方案、可行性研究、标准技术报告 |
| OT003 | 详细版深度报告 | 详细 | 7-9 | 科研报告、技术白皮书、详细设计方案 |
| OT004 | 技术方案报告 | 标准 | 5-6 | 技术设计、工程方案、技术评审 |
| OT005 | 项目实施方案 | 标准 | 5-6 | 项目管理、施工组织、实施计划 |

#### 行业大纲模板（按行业类型）

| 模板ID | 模板名称 | 行业类型 | 章节数量 | 标准依据 |
|--------|---------|---------|---------|---------|
| OT101 | 地质调查报告 | 地质调查 | 7-9 | DZ/T 0206-2006、GB/T 14158-2010 |
| OT102 | 工程设计方案 | 工程设计 | 9-10 | GB 50021-2016、GB 50300-2013 |
| OT103 | 环境影响评估报告 | 环境评估 | 9-10 | HJ 169-2018、HJ 2.1-2016 |

### 使用方法

#### 通过 generate_outline.py 使用

```bash
# 快速生成，自动选择模板
python scripts/generate_outline.py \
  --input "风电场地质调查报告" \
  --mode quick \
  --output outline-generated.md

# 指定模板生成
python scripts/generate_outline.py \
  --input "风电项目" \
  --mode quick \
  --template OT101 \
  --output outline-generated.md
```

#### 模板选择指南

根据项目类型选择合适的模板：

**地质调查项目**：
- 推荐模板：OT101（地质调查报告）
- 包含章节：总论、地质概况、工程地质条件、环境地质、调查方法、调查成果、结论
- 适用标准：DZ/T 0206-2006

**工程设计项目**：
- 推荐模板：OT102（工程设计方案）
- 包含章节：设计总论、总体设计、建筑设计、结构设计、设备设计、消防设计、节能设计、专项设计、设计概算、技术经济指标
- 适用标准：GB 50021-2016、GB 50300-2013

**环境影响评估项目**：
- 推荐模板：OT103（环境影响评估报告）
- 包含章节：总论、项目概况、环境现状、环境影响预测、环境保护措施、环境经济损益分析、环境监测与管理、环境影响评价结论、附录
- 适用标准：HJ 169-2018、HJ 2.1-2016

**快速报告**：
- 推荐模板：OT001（精简版）
- 包含章节：项目背景、主要内容、结论与建议
- 适合：内部沟通、快速评估、总结汇报

**标准技术报告**：
- 推荐模板：OT002（标准版）或 OT004（技术方案）
- 包含章节：项目背景、技术方案、实施计划、质量保证、投资估算、结论与建议
- 适合：项目方案、可行性研究、技术评审

**深度研究报告**：
- 推荐模板：OT003（详细版）
- 包含章节：综合概述、文献综述、方法论、详细方案、实施与管理、效果评估、结论与展望、案例分析、参考文献
- 适合：科研报告、技术白皮书、详细设计

### 大纲模板格式

所有大纲模板采用统一的 Markdown 格式：

```markdown
# 模板名称

## 基本信息
- 模板ID: OTxxx
- 报告类型: [类型]
- 适用场景: [场景]
- 详细程度: 精简/标准/详细
- 章节数量: [数量]

## 章节结构

### 第1章 [章节标题]
#### 1.1 [小节标题]
#### 1.2 [小节标题]

### 第2章 [章节标题]
...

## 写作要点
- [要点1]
- [要点2]

## 参考资料
- [参考1]
- [参考2]
```

### 模板特色

#### 标准模板特色
- ✅ 适用于大多数工程技术项目
- ✅ 章节结构完整、逻辑清晰
- ✅ 易于调整和定制
- ✅ 包含写作要点和参考

#### 行业模板特色
- ✅ 符合行业标准格式要求
- ✅ 包含行业特定章节结构
- ✅ 参考行业标准文档
- ✅ 专业技术术语准确性高

### 与 Word 模板的关系

大纲模板与 Word 模板是互补关系：
- **大纲模板**（Markdown）：定义报告的章节结构和内容框架
- **Word 模板**（.docx）：定义最终的排版格式和样式

使用流程：
1. **阶段1**：使用大纲模板生成报告结构（Markdown格式）
2. **阶段2**：根据大纲逐章编写内容（使用 report-generator skill）
3. **阶段3**：将所有章节整合到 Word 文档
4. **阶段4**：使用 Word 模板应用专业格式

### 自定义大纲模板

如果您想创建自己的大纲模板：

1. 在 `iteration/outline-templates/` 目录下创建新的 Markdown 文件
2. 按照"大纲模板格式"编写内容
3. 在 `iteration/outline-templates/index.md` 中添加模板索引
4. 更新 `iteration/outline-templates/standard-outline-templates.md`（如果是标准模板）或创建行业模板文件

### 相关文件

- `iteration/outline-templates/README.md` - 本文件
- `iteration/outline-templates/index.md` - 模板索引
- `iteration/outline-templates/standard-outline-templates.md` - 标准大纲模板
- `iteration/outline-templates/industry-outlines/` - 行业大纲模板
- `SKILL.md` - report-generator skill 主文档（包含大纲生成功能说明）
- `USAGE.md` - 使用指南（包含大纲生成功能使用说明）
- `scripts/generate_outline.py` - 大纲生成脚本
- `scripts/outline_editor.py` - 大纲编辑器
- `scripts/outline_manager.py` - 大纲管理工具

---

*最后更新：2026-02-04*

**适用场景：**
- 一般工程技术报告
- 项目实施方案
- 技术方案报告
- 可行性研究报告

**特点：**
- 简洁通用的工程报告格式
- 适用于大多数工程技术文档
- 易于定制和修改

---

## 如何使用模板

### 方式1：通过 report-generator skill 自动使用

在阶段4（生成Word文档）中，系统会提示你选择模板：

```
请选择报告要使用的Word模板：

A. 地质资料归档格式模板 ⭐ 推荐
B. 通用工程技术报告模板
C. 生成新模板
D. 不使用模板（默认样式）
```

### 方式2：Pandoc 命令行使用

```bash
pandoc report-complete.md -o output.docx \
  --reference-doc=templates/geological-survey-template.docx \
  --toc \
  --number-sections
```

### 方式3：在 Microsoft Word 中直接使用

1. 打开模板文件（如 `geological-survey-template.docx`）
2. 根据示例内容修改为你的实际内容
3. 保持样式不变，只修改文字
4. 使用预定义的样式快速格式化

---

## 添加新模板

如果你想添加新的模板到模板库：

### 步骤1：准备模板文件

1. 在 Microsoft Word 中创建或修改文档
2. 设置所有需要的样式（标题、正文、表格、图片等）
3. 保存为 `.docx` 格式

### 步骤2：命名规范

模板文件命名应遵循以下规范：

```
{模板类型}-template.docx
```

示例：
- `geological-survey-template.docx` - 地质调查模板
- `engineering-design-template.docx` - 工程设计模板
- `academic-report-template.docx` - 学术报告模板

### 步骤3：放置到 templates 目录

将模板文件复制到 `report-generator/templates/` 目录：

```bash
cp your-template.docx report-generator/templates/
```

### 步骤4：更新模板列表

在 `SKILL.md` 的 "步骤4.0 - 选择Word模板" 部分添加新模板的说明。

---

## 模板生成脚本

### 地质资料归档格式模板生成

如果需要重新生成地质资料归档格式模板：

```bash
# 在工作目录下执行
node create_geological_template.js

# 生成的文件会自动保存为：
# 地质资料归档格式模板.docx

# 复制到 templates 目录
cp 地质资料归档格式模板.docx report-generator/templates/geological-survey-template.docx
```

### 自定义模板生成

你可以基于 `create_geological_template.js` 创建自己的模板生成脚本：

1. 复制 `create_geological_template.js` 为新的脚本文件
2. 修改样式定义（字体、字号、间距等）
3. 修改页面设置（边距、装订线等）
4. 修改示例内容
5. 执行脚本生成新模板

---

## 模板样式参考

### 字号对照表

| 中文名称 | 磅值 (pt) | Word字号 (half-points) | 用途 |
|---------|----------|----------------------|------|
| 小一号 | 26pt | 52 | 封面题名 |
| 二号 | 22pt | 44 | 扉页题名、章标题 |
| 三号 | 16pt | 32 | 节标题、目录标题 |
| 小三号 | 15pt | 30 | 封面副标题、日期 |
| 四号 | 14pt | 28 | 段标题、扉页信息 |
| 五号 | 10.5pt | 21 | 正文、表号、表名 |
| 小五号 | 9pt | 18 | 表文、参考文献 |
| 六号 | 7.5pt | 15 | 表注、图注 |

### 单位转换

- **厘米转DXA**：1cm ≈ 567 DXA（Word使用DXA单位）
- **磅转half-points**：1pt = 2 half-points

---

## 常见问题

### Q1: 模板中的中文字体显示不正常？

**A:** 确保你的系统已安装以下中文字体：
- 宋体 (SimSun)
- 黑体 (SimHei)
- 楷体 (KaiTi)
- 仿宋 (FangSong)

如果字体缺失，Word会自动替换为可用字体，可能导致格式略有差异。

### Q2: 如何修改现有模板？

**A:** 
1. 在 Word 中打开模板文件
2. 修改样式定义（开始 → 样式 → 右键修改）
3. 保存文件
4. 建议备份原模板

### Q3: 模板可以在不同Word版本中使用吗？

**A:** 是的，但不同Word版本可能对样式的渲染有细微差异。建议在目标Word版本中验证格式。

### Q4: 如何创建符合特定行业标准的模板？

**A:**
1. 查阅该行业的文档格式标准
2. 根据标准修改 `create_geological_template.js` 中的样式定义
3. 执行脚本生成新模板
4. 在 Word 中验证格式是否符合要求

---

## 更新日志

### 2026-02-03
- ✅ 添加地质资料归档格式模板 (geological-survey-template.docx)
- ✅ 符合河南省国土资源厅豫国土资发［2006］144号文标准
- ✅ 包含完整的封面、扉页、目录、正文、表格、图片、参考文献样式

---

## 相关文件

- `SKILL.md` - report-generator skill 主文档，包含模板选择流程
- `create_geological_template.js` - 地质资料归档格式模板生成脚本
- `../iteration/usage-log.md` - 模板使用记录

---

*最后更新：2026-02-03*
